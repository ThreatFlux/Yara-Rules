import "pe"
include "../../private/executables/native/pe.yar"

rule PE_Sequential_Numbered_Pattern 
{
    meta:
        description = "Detects PE with sequential numbered patterns in array format"
        author = "Security Researcher"
        date = "2024-01-05"
        version = "1.3"
        sha256 = "59133176b63058cbdc2a5c5d85bab194291e2037d4a649f49c2e20d4e76fb25e"
        
    strings:
        // Distinctive array patterns from the data section
        $array1 = { 30 30 34 30 38 30 3C 30 40 30 44 30 48 30 4C 30 }
        $array2 = { 38 3F 3C 3F 40 3F 44 3F 48 3F 4C 3F 50 3F 54 3F }
        $array3 = { 31 34 31 38 31 3C 31 40 31 44 31 48 31 4C 31 50 }
        $array4 = { 3C 3D 40 3D 44 3D 48 3D 4C 3D 50 3D 54 3D 58 3D }

    condition:
        PE_Structure and // PE file
        pe.number_of_sections >= 8 and 
        filesize < 1MB and
        pe.sections[0].name == ".text" and
        pe.sections[1].name == ".text1" and
        pe.sections[5].name == ".trace" and
        2 of ($array*)
}
